{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "collapsible",
  "title": "Collapsible",
  "description": "Animated Collapsible component",
  "dependencies": [
    "motion",
    "@radix-ui/react-collapsible"
  ],
  "registryDependencies": [],
  "files": [
    {
      "path": "registry/components/collapsible.tsx",
      "content": "\"use client\";\n\nimport React from \"react\";\nimport { Collapsible as CollapsiblePrimitive } from \"radix-ui\";\nimport { motion, AnimatePresence } from \"motion/react\";\nimport { cn } from \"@/lib/utils\";\n\ntype CollapsibleContextType = {\n\theight: number | null;\n\tsetHeight: (v: number) => void;\n\tmaxIndex: number;\n\tsetMaxIndex: (v: number) => void;\n\tisOpen: boolean;\n};\n\nconst CollapsibleContext = React.createContext<CollapsibleContextType | null>(\n\tnull,\n);\n\nfunction useCollapsibleContext() {\n\tconst context = React.useContext(CollapsibleContext);\n\tif (!context) {\n\t\tthrow new Error(\n\t\t\t\"useCollapsibleContext must be used within a CollapsibleContext.Provider\",\n\t\t);\n\t}\n\treturn context;\n}\n\nexport function Collapsible({\n\tclassName,\n\topen,\n\tonOpenChange,\n\tdefaultOpen,\n\t...props\n}: CollapsiblePrimitive.CollapsibleProps) {\n\tconst [height, setHeight] = React.useState<number | null>(null);\n\tconst [maxIndex, setMaxIndex] = React.useState<number>(0);\n\tconst [isOpen, setIsOpen] = React.useState(defaultOpen ?? false);\n\n\tconst handleOpenChange = (val: boolean) => {\n\t\tsetIsOpen(val);\n\t\tonOpenChange?.(val);\n\t};\n\n\treturn (\n\t\t<CollapsibleContext.Provider\n\t\t\tvalue={{\n\t\t\t\theight,\n\t\t\t\tsetHeight,\n\t\t\t\tisOpen: open ?? isOpen,\n\t\t\t\tmaxIndex,\n\t\t\t\tsetMaxIndex,\n\t\t\t}}\n\t\t>\n\t\t\t<CollapsiblePrimitive.Root\n\t\t\t\tclassName={cn(\"flex flex-col justify-center items-center\", className)}\n\t\t\t\topen={open ?? isOpen}\n\t\t\t\tonOpenChange={handleOpenChange}\n\t\t\t\tdefaultOpen={defaultOpen}\n\t\t\t\t{...props}\n\t\t\t/>\n\t\t</CollapsibleContext.Provider>\n\t);\n}\n\nexport function CollapsibleTrigger({\n\t...props\n}: CollapsiblePrimitive.CollapsibleTriggerProps) {\n\treturn <CollapsiblePrimitive.Trigger {...props} />;\n}\n\nexport function CollapsibleContent({\n\tclassName,\n\tchildren,\n\t...props\n}: Omit<React.HTMLAttributes<HTMLDivElement>, \"children\"> & {\n\tchildren: React.ReactNode;\n}) {\n\tconst { setMaxIndex, isOpen } = useCollapsibleContext();\n\n\tReact.useEffect(() => {\n\t\tsetMaxIndex(React.Children.count(children));\n\t}, [children, setMaxIndex]);\n\n\treturn (\n\t\t<CollapsiblePrimitive.Content\n\t\t\tclassName={cn(\n\t\t\t\t\"m-2 flex flex-col gap-2\",\n\t\t\t\tisOpen ? \"h-auto\" : \"h-32.5\",\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t\tforceMount\n\t\t\t{...props}\n\t\t>\n\t\t\t<AnimatePresence mode=\"popLayout\" initial={false}>\n\t\t\t\t{children}\n\t\t\t</AnimatePresence>\n\t\t</CollapsiblePrimitive.Content>\n\t);\n}\n\nexport type CollapsibleItemProps = React.ComponentPropsWithoutRef<\n\ttypeof motion.div\n> & {\n\tindex: number;\n\topen?: boolean;\n};\n\nexport function CollapsibleItem({\n\tchildren,\n\tclassName,\n\tindex,\n\topen: openProp,\n\t...motionProps\n}: CollapsibleItemProps) {\n\tconst {\n\t\tmaxIndex,\n\t\theight,\n\t\tsetHeight,\n\t\tisOpen: contextOpen,\n\t} = useCollapsibleContext();\n\tconst internalRef = React.useRef<HTMLDivElement | null>(null);\n\tconst open = openProp ?? contextOpen;\n\tconst closedHeight = height ?? 90;\n\n\tReact.useEffect(() => {\n\t\tif (internalRef.current && index === 0) {\n\t\t\tsetHeight(internalRef.current.clientHeight);\n\t\t}\n\t}, [index, setHeight]);\n\n\treturn (\n\t\t<motion.div\n\t\t\tlayout\n\t\t\tanimate={\n\t\t\t\topen\n\t\t\t\t\t? { scale: 1, y: 0, opacity: 1 }\n\t\t\t\t\t: {\n\t\t\t\t\t\t\tscale: 1 - 0.05 * index,\n\t\t\t\t\t\t\ty: 0 - index * closedHeight,\n\t\t\t\t\t\t\topacity: index > 3 ? 0 : 1,\n\t\t\t\t\t\t}\n\t\t\t}\n\t\t\tinitial={\n\t\t\t\topen || maxIndex < 4\n\t\t\t\t\t? {\n\t\t\t\t\t\t\tscale: 0.8,\n\t\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\t\ty: 0 - index * closedHeight + (height ?? 90) / 2,\n\t\t\t\t\t\t}\n\t\t\t\t\t: false\n\t\t\t}\n\t\t\texit={\n\t\t\t\topen\n\t\t\t\t\t? { scale: 0.8, opacity: 0, y: -20 }\n\t\t\t\t\t: { scale: 0.8, opacity: 0, y: 0 - index * closedHeight - 20 }\n\t\t\t}\n\t\t\tclassName={cn(\n\t\t\t\t\"flex bg-card w-lg min-h-24 h-fit rounded-2xl border p-4 gap-x-2 shadow-xl\",\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t\tstyle={{ zIndex: 0 - index, ...motionProps.style }}\n\t\t\ttransition={{\n\t\t\t\tduration: 0.35,\n\t\t\t\ttype: \"spring\",\n\t\t\t\tbounce: 0.15,\n\t\t\t}}\n\t\t\t{...motionProps}\n\t\t>\n\t\t\t{children}\n\t\t</motion.div>\n\t);\n}\n\nexport { useCollapsibleContext };\n",
      "type": "registry:component",
      "target": "components/collapsible.tsx"
    }
  ],
  "type": "registry:component"
}